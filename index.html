
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>YT Video + Subtitles Speak</title>
  <style>
    body { font-family: sans-serif; padding: 20px; text-align: center; }
    iframe { width: 100%; max-width: 560px; height: 315px; margin: 20px auto; display: block; }
    select, button { margin: 10px; padding: 10px; font-size: 16px; }
    #output { margin-top: 20px; font-size: 18px; line-height: 1.5; }
  </style>
</head>
<body>
  <h2>YouTube Video with Subtitles and Voice</h2>

  <select id="videoSelect">
        <option value="">-- Select a video --</option>
        <option value="1">Video 1</option>
        <option value="2">Video 2</option>
        <option value="3">Video 3</option>
  </select>
  
  <button id="playBtn">▶️ Play & Speak</button>

  <iframe id="ytFrame" src="" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>

  <div id="output"></div>

  <script>
    const videos = {
        "1": "https://www.youtube.com/embed/-jxdQTSEXEo?enablejsapi=1",
        "2": "https://www.youtube.com/embed/0e4JjNryU90?enablejsapi=1",
        "3": "https://www.youtube.com/embed/0znTbKmCRz4?enablejsapi=1",
    };

    let currentSubs = [];

    function loadSubtitleScript(n) {
      const oldScript = document.getElementById("subtitleScript");
      if (oldScript) oldScript.remove();

      const script = document.createElement("script");
      script.id = "subtitleScript";
      script.src = "sub" + n + ".js";
      script.onload = () => {
        currentSubs = window.subtitleData || [];
        const out = document.getElementById("output");
        out.innerHTML = currentSubs.map(item => `<p>${item.text}</p>`).join("");
      };
      script.onerror = () => {
        document.getElementById("output").innerText = "Failed to load subtitles.";
        currentSubs = [];
      };
      document.body.appendChild(script);
    }

    document.getElementById("videoSelect").addEventListener("change", function() {
      const vid = this.value;
      if (!vid) return;
      document.getElementById("ytFrame").src = videos[vid];
      loadSubtitleScript(vid);
    });

    document.getElementById("playBtn").addEventListener("click", async () => {
      if (!currentSubs.length) return alert("No subtitles loaded");
      for (const line of currentSubs) {
        const utter = new SpeechSynthesisUtterance(line.text);
        utter.lang = "en-US";
        speechSynthesis.speak(utter);
        await new Promise(res => utter.onend = res);
      }
    });
  </script>
</body>
</html>
